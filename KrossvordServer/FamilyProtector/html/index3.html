<html>
<head>


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">





    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.7/angular-resource.min.js"></script>
    <link rel="stylesheet" href="ui-bootstrap-2.5.0-csp.css" >
    <script src="ui-bootstrap-tpls-2.5.0.min.js"></script>




    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


    <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
    <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/angular-bootstrap-toggle@0.4.0/dist/angular-bootstrap-toggle.min.css">
    <script src="https://cdn.jsdelivr.net/npm/angular-bootstrap-toggle@0.4.0/dist/angular-bootstrap-toggle.min.js"></script>


    <style>
        /* The switch - the box around the slider */

        .labels {
            color: white;
            background-color: red;
            font-family: "Lucida Grande", "Arial", sans-serif;
            font-size: 10px;
            text-align: center;
            width: 10px;
            white-space: nowrap;
        }
        #map {
            height: 100%;
        }
        /* Optional: Makes the sample page fill the window. */



        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        /* Hide default HTML checkbox */
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        /* The slider */
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            -webkit-transition: .4s;
            transition: .4s;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            -webkit-transition: .4s;
            transition: .4s;
        }

        input:checked + .slider {
            background-color: #006af3;
        }

        input:focus + .slider {
            box-shadow: 0 0 1px #004cf3;
        }

        input:checked + .slider:before {
            -webkit-transform: translateX(26px);
            -ms-transform: translateX(26px);
            transform: translateX(26px);
        }

        /* Rounded sliders */
        .slider.round {
            border-radius: 34px;
        }

        .slider.round:before {
            border-radius: 50%;
        }
    </style>

</head>



<body ng-app="app" ng-controller="myCtrl">

<nav class="navbar navbar-expand-lg fixed-top navbar-light bg-light">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="#">Familyprotector</a>


    <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
        <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
            <li class="nav-item active">
                <a class="nav-link" href="#" ng-click="m=false;v=false;g=true;y=false;w=false;whatsapp=false;whatsappc=false;gundelik()" >Gundelik <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" ng-click="m=false;v=true;g=false;y=false;w=false;whatsapp=false;whatsappc=false;">Proqramlar</a>
            </li>
            <li class="nav-item">
                <a class="nav-link " href="#" ng-click="m=true;v=false;g=false;y=false;w=false;whatsapp=false;whatsappc=false;location();">Xerite</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#"  ng-click="m=false;v=false;g=false;y=false;w=false;whatsapp=true;whatsappc=false;whatsappf();">Whatsapp</a>
            </li>
            <li class="nav-item">
                <a class="nav-link disabled" href="#">Facebook</a>
            </li>
            <li class="nav-item">
                <a class="nav-link " href="#" ng-click="m=false;v=false;g=false;y=true;w=false;whatsapp=false;whatsappc=false; yact()">Youtube</a>
            </li>
            <li class="nav-item">
                <a class="nav-link " href="#" ng-click="m=false;v=false;g=false;y=false;w=true;whatsapp=false;whatsappc=false; Web()">Saytlar</a>
            </li>
        </ul>
        <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form>
    </div>
</nav>
<select class="browser-default custom-select custom-select-lg mb-3 ">
    <option selected>Open this select menu</option>
    <option value="1">One</option>
    <option value="2">Two</option>
    <option value="3">Three</option>
</select>


<div >

    <select class="browser-default custom-select custom-select-lg mb-3">
        <option selected>Ulvi</option>
        <option value="1">Kamal</option>
        <option value="2">Qalib</option>
        <option value="3">Semed</option>
    </select>

    <div id="map" ng-show="m" ></div>

    <table class="table" ng-show="v">
        <thead>

        </thead>
        <tbody>
        <tr ng-repeat="m in aa">
            <td><img ng-src="http://tmhgame.tk/{{m.package}}.png" style="width: 60px; height: 60px"></td>
            <td>
                <h5 >{{m.name}}</h5>
                <h5>{{$index}}</h5>
                <h5>{{m[$index].blocked}}</h5>
            </td>
            <td>
                <h5>{{m.blocked == false?'Açıq':'Bağlı' }}</h5>
                <label class="switch">
                    <input type="checkbox"  ng-click="block(scope, m.package, m, $event)"  ng-checked="aa[$index].blocked"   >
                    <span class="slider"></span>
                </label>

            </td>
        </tr>
        </tbody>
    </table>

    <table class="table" ng-show="g">
        <thead>

        </thead>
        <tbody>
        <tr ng-repeat="m in gunluk">
            <td><img ng-src="http://tmhgame.tk/{{m.package}}.png" style="width: 60px; height: 60px"></td>
            <td>
                <h5 >{{m.name}}</h5>
                <p>{{toTime(m.start)}}</p>
                <h5>{{m[$index].blocked}}</h5>
            </td>
            <td>
                <h5>{{m.end == 9007199254740992 ? 'Aktiv' : (toDuration(m.duration))}}  </h5>
<!--                <label class="switch">-->
<!--                    <input type="checkbox"  ng-click="block(scope, m.package, m, $event)"  ng-checked="aa[$index].blocked"  id="{{m.package}}" >-->
<!--                    <span class="slider"></span>-->
<!--                </label>-->
            </td>
        </tr>
        </tbody>
    </table>

    <table class="table" ng-show="y">
        <thead>

        </thead>
        <tbody>
        <tr ng-repeat="m in youtubes">
            <td><img ng-src="http://tmhgame.tk/com.google.android.youtube.png" style="width: 60px; height: 60px"></td>
            <td>
                <h5 >{{m.name}}</h5>
                <p>{{toTime(m.start)}}</p>
<!--                <h5>{{m[$index].blocked}}</h5>-->
            </td>
            <td>
                <button type="button" class="btn btn-dark" ng-click="openy(m.url)">Bax</button>
<!--                <h5>{{m.end == 9007199254740992 ? 'Aktiv' : (toDuration(m.duration))}}  </h5>-->
                <!--                <label class="switch">-->
                <!--                    <input type="checkbox"  ng-click="block(scope, m.package, m, $event)"  ng-checked="aa[$index].blocked"  id="{{m.package}}" >-->
                <!--                    <span class="slider"></span>-->
                <!--                </label>-->
            </td>
        </tr>
        </tbody>
    </table>

    <table class="table" ng-show="w">
        <thead>

        </thead>
        <tbody>
        <tr ng-repeat="m in websites">
            <td><img ng-src="http://tmhgame.tk/com.android.chrome.png" style="width: 60px; height: 60px"></td>
            <td>
                <h5 style="display: block;width: 100px;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;">{{m.url}}</h5>
                <p>{{toTime(m.start)}}</p>
                <!--                <h5>{{m[$index].blocked}}</h5>-->
            </td>
            <td>
                <button type="button" class="btn btn-dark" ng-click="openy(m.url)">Bax</button>
                <!--                <h5>{{m.end == 9007199254740992 ? 'Aktiv' : (toDuration(m.duration))}}  </h5>-->
                <!--                <label class="switch">-->
                <!--                    <input type="checkbox"  ng-click="block(scope, m.package, m, $event)"  ng-checked="aa[$index].blocked"  id="{{m.package}}" >-->
                <!--                    <span class="slider"></span>-->
                <!--                </label>-->
            </td>
        </tr>
        </tbody>
    </table>


    <table class="table" ng-show="whatsapp">
        <thead>

        </thead>
        <tbody>
        <tr ng-repeat="m in whatsaps" ng-click="openc(m)">
            <td><img ng-src="http://tmhgame.tk/com.whatsapp.png" style="width: 60px; height: 60px"></td>
            <td>
                <h5 >{{m.sender}}</h5>
                <p>{{m.number}}</p>
            </td>
            <td>
                <p>{{toHour(m.con[m.con.length-1].time)}}</p>
                <p>{{m.con.length}} SMS</p>
            </td>
        </tr>
        </tbody>
    </table>


    <table id="ctable" class="table" ng-show="whatsappc" >
        <thead>

        </thead>
        <tbody>
        <tr ng-repeat="m in curConversation.con" >
            <td><img ng-src="http://tmhgame.tk/com.whatsapp.png" style="width: 60px; height: 60px"></td>
            <td>
                <h5 >{{m.sender}}</h5>
                <p>{{m.content}}</p>
            </td>
            <td>
<!--                <p>{{toHour(m.con[m.con.length-1].time)}}</p>-->
                <p>{{toTime(m.time)}}</p>
            </td>
        </tr>
        </tbody>
    </table>

</div>





<script>

   let an = angular.module("app", ['ui.bootstrap','ui.toggle']).controller("myCtrl", function($scope, $http) {
        $scope.message=["Hello Wdsdorld",'dasdas'];
        $scope.whatsapp = false;
        $scope.whatsappc = false;
        $scope.v = true;
        $scope.w = true;
        $scope.m = false;
        $scope.g = false;
        $scope.y = false;
        $scope.txt = "asdsd";
        $scope.markers = [];
        $scope.flightPath = null;
        $scope.whatsaps = [];
        $scope.curConversation = null;

        $scope.openc = function(m) {
            console.log("Openc called");
            $scope.whatsapp = false;
            $scope.whatsappc = true;
            $scope.v = false;
            $scope.w = false;
            $scope.m = false;
            $scope.g = false;
            $scope.y = false;
            $scope.curConversation = m;
            setTimeout(function () {
                $( "body" ).scrollTop(1000000);
            }, 100);
        }
       $scope.isToday = function(someDate){
           const today = new Date();
           return someDate.getDate() == today.getDate() &&
               someDate.getMonth() == today.getMonth() &&
               someDate.getFullYear() == today.getFullYear()
       }
        $scope.toHour = function(time) {
            let d = new Date(time);
            if(!$scope.isToday(d)) {
                return ((d.getMonth() > 8) ? (d.getMonth() + 1) : ('0' + (d.getMonth() + 1))) + '/' + ((d.getDate() > 9) ? d.getDate() : ('0' + d.getDate())) + '/' + d.getFullYear();
            }
            let h = d.getHours();
            let m = d.getMinutes();

            h = (h<10) ? '0' + h : h;
            m = (m<10) ? '0' + m : m;

            return h + ':' + m;
        }
        $scope.addAlert = function() {
            $scope.alerts.push({msg: 'Another alert!'});
        };
       $scope.openy = function(url) {
           if(!url.startsWith('http://')) {
               url = 'http://' + url;
           }
           window.open(url);
       };

        $scope.toTime = function(d) {
            d = parseInt(d);
            console.log(d);
            let ans = new Date(d).toLocaleString();

            ans = ans.substring(0,ans.length-3)
            return ans;
        }
        $scope.toDuration = function(d) {

            if(d < 60) {
                return d + " San";
            }else {
                d = $scope.divide(d, 60);
                return d + " Dəq";
            }
        }
        $scope.divide = function(a,b) {
            let ans = a / b;
            return parseInt(ans);
        }
        $scope.closeAlert = function(index) {
            $scope.alerts.splice(index, 1);
        };

        $scope.myFunc = function() {
            $scope.count++;
            console.log("asdads");
        };
        $scope.block = function(a,b,c,d) {
            let block = (c.blocked) ? 0 : 1;
            console.log(b);
            console.log("block status gonderildi " + block)

            $http.get('http://tmhgame.tk/blockApp?imei='+$scope.d.imei+'&package='+b+'&block='+block).then(function (d) {
                console.log(d.data.apps + " " + $scope.imei);

                c.blocked = c.blocked ^ true;

            }, function () {

            });

        };


       $scope.location = function() {

           console.log("Location Called");

           $http.get('http://tmhgame.tk/sendCommand?imei=356769106360753&sendLocation=1').then(function (d) {
               console.log(d.data.locations);
               if(d.data.locations == undefined) {
                   return;
               }

               $scope.locations = d.data.locations;

               $scope.locations.reverse();
               if($scope.locations == undefined) {
                   console.log("SendCommand Time out" + map);

                   return;
               }
               let l = $scope.locations;

               let flightPlanCoordinates = [];

               for(let i = 0; i < $scope.markers.length; i++) {
                   $scope.markers[i].setMap(null);
               }
               if($scope.flightPath != null) {
                   $scope.flightPath.setMap(null);
               }
               for(let i = 0; i < l.length; i++) {

                   console.log("marker added");
                   l[i].lo = parseFloat(l[i].lo);
                   l[i].la = parseFloat(l[i].la);

                   if(i == l.length-1) {
                       map.setCenter({lat: l[i].la, lng: l[i].lo});
                   }
                   flightPlanCoordinates.push( {lat: l[i].la, lng: l[i].lo});
                   let time = $scope.toTime(parseInt(l[i].time));
                   time = time.substring(time.length - 5);

                   if(i == 0 || i == l.length - 1) {
                       let marker = new google.maps.Marker({
                           position: {lat: l[i].la, lng: l[i].lo},
                           map: map,
                           label: {
                               text: (i+1) +") " + time,
                               color: "#0006eb",
                               fontSize: "20px"
                           },
                           draggable:true,
                           icon: {
                               url: 'http://tmhgame.tk/googlemapicon.png',
                               origin: new google.maps.Point(0, 0),
                               labelOrigin: new google.maps.Point(20, -10)
                           },
                           labelClass:'labels'
                       });
                       $scope.markers.push(marker);
                   }
               }
               
               let lineSymbol = {
                   path: google.maps.SymbolPath.FORWARD_CLOSED_ARROW,
                   strokeOpacity: 1,
                   scale: 4
               };
               $scope.flightPath = new google.maps.Polyline({
                   path: flightPlanCoordinates,
                   strokeOpacity: 0,
                   icons: [{
                       icon: lineSymbol,
                       offset: '0',
                       repeat: '20px'
                   }],
                   map: map
               });




           }, function () {

           });

       }

        $scope.Web = function() {

            $http.get('http://tmhgame.tk/sendCommand?imei=356769106360753&sendWebsites=1').then(function (d) {
                console.log(d.data.data);
                if(d.data.data == undefined) {
                    return;
                }

                $scope.websites = d.data.data;
                $scope.websites.reverse();
                if($scope.websites == undefined) {
                    console.log("SendCommand Time out");
                    return;
                }
            }, function () {

            });

        }
       $scope.whatsappf = function() {

           $http.get('http://tmhgame.tk/Whatsapp?imei=356769106360753').then(function (d) {
               console.log(d);
               $scope.whatsaps = d.data.con;
               $scope.whatsaps.sort(function (a, b) {
                   return b.con[b.con.length - 1].time - a.con[a.con.length - 1].time;
               })
               console.log($scope.whatsaps)
           }, function () {

           });

       }
        $scope.gundelik = function() {

            $http.get('http://tmhgame.tk/sendCommand?imei=356769106360753').then(function (d) {
                console.log(d.data.data);

                $scope.gunluk = d.data.data;
                if($scope.gunluk == undefined) {
                    console.log("SendCommand Time out");
                    return;
                }
                let t = [];
                for(let i = 0; i < $scope.aa.length; i++) {
                    t[$scope.aa[i].package] = 1;
                }
                let ans = [];
                for(let i = 0; i < $scope.gunluk.length; i++) {
                    if(t[$scope.gunluk[i].package] == undefined)continue;
                    $scope.gunluk[i].start = parseInt($scope.gunluk[i].start);
                    $scope.gunluk[i].end = parseInt($scope.gunluk[i].end);
                    $scope.gunluk[i].duration = $scope.gunluk[i].end - $scope.gunluk[i].start;
                    $scope.gunluk[i].duration = $scope.divide($scope.gunluk[i].duration, 1000);
                    if($scope.gunluk[i].end == -1) {
                        $scope.gunluk[i].end = 9007199254740992;
                        //$scope.gunluk[i] = 9007199254740992;

                    }
                    ans.push($scope.gunluk[i]);

                    console.log($scope.gunluk[i].duration);

                }
                $scope.gunluk = ans;
                
                $scope.gunluk.sort(function (a,b) {
                    return b.end-a.end;
                })

            }, function () {

            });

        }

       $scope.yact = function() {

           $http.get('http://tmhgame.tk/sendCommand?imei=356769106360753&youtube=1').then(function (d) {
               console.log(d.data.data);
               if(d.data.data == undefined) {
                   return;
               }

               $scope.youtubes = d.data.data;
               $scope.youtubes.reverse();
               if($scope.youtubes == undefined) {
                   console.log("SendCommand Time out");
                   return;
               }
               for(let i = 0; i < $scope.youtubes.length; i++) {
                   //https://www.youtube.com/results?search_query=the+show+must+go+on
                   $scope.youtubes[i].url = "www.youtube.com/results?search_query=" + encodeURI($scope.youtubes[i].name);
                   console.log($scope.youtubes[i].url)
               }
               console.log($scope.youtubes);
           }, function () {

           });

       }
       $scope.yact();
        $scope.Web();

        //$scope.aa=[];
        $http.get('http://tmhgame.tk/getDevice?imei=356769106360753').then(function (d) {
            console.log(d.data.apps);
            if(d.data.apps == undefined) {
                return;
            }
            $scope.d = d.data;
            console.log(d.data.imei);
            $scope.aa = d.data.apps;




            
        }, function () {

        });


    } )



</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAT8fPfM4fsk3kwvoxbSn4340zV4Gi6rko&callback=initMap"
        async defer></script>

<script>
    var map;
    function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
            center: {lat: 40.6506034, lng: 46.5340354},
            zoom: 15
        });

    }

    $('.navbar-nav>li>a').on('click', function(){
        $('.navbar-collapse').collapse('hide');
    });
</script>


</body>
</html>